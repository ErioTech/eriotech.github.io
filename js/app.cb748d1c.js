(function(t){function i(i){for(var n,o,h=i[0],r=i[1],c=i[2],u=0,f=[];u<h.length;u++)o=h[u],Object.prototype.hasOwnProperty.call(e,o)&&e[o]&&f.push(e[o][0]),e[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);l&&l(i);while(f.length)f.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,i=0;i<s.length;i++){for(var a=s[i],n=!0,h=1;h<a.length;h++){var r=a[h];0!==e[r]&&(n=!1)}n&&(s.splice(i--,1),t=o(o.s=a[0]))}return t}var n={},e={app:0},s=[];function o(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,i,a){o.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,i){if(1&i&&(t=o(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)o.d(a,n,function(i){return t[i]}.bind(null,n));return a},o.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(i,"a",i),i},o.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},o.p="";var h=window["webpackJsonp"]=window["webpackJsonp"]||[],r=h.push.bind(h);h.push=i,h=h.slice();for(var c=0;c<h.length;c++)i(h[c]);var l=r;s.push([0,"chunk-vendors"]),a()})({0:function(t,i,a){t.exports=a("56d7")},"56d7":function(t,i,a){"use strict";a.r(i);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("7a23");function e(t,i,a,e,s,o){var h=Object(n["resolveComponent"])("Canvas");return Object(n["openBlock"])(),Object(n["createBlock"])(h,{width:650,height:650})}a("b0c0");var s=Object(n["withScopeId"])("data-v-0aa86c20");Object(n["pushScopeId"])("data-v-0aa86c20");var o={class:"author-div"};Object(n["popScopeId"])();var h=s((function(t,i,e,s,h,r){return Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["createVNode"])("div",{style:{width:"".concat(h.width,"px"),height:"".concat(h.height,"px")},class:"outer-div"},[Object(n["createVNode"])("div",{class:"name-div",style:{"font-size":"".concat(r.fontSizeName,"px")}},Object(n["toDisplayString"])(void 0!==this.player.musicName?t.name=this.player.musicName:""),5),Object(n["createVNode"])("div",o,Object(n["toDisplayString"])(void 0!==this.player.musicAuthor?t.name=this.player.musicAuthor:""),1),Object(n["createVNode"])("div",{class:"album-div",style:{"font-size":"".concat(r.fontSizeAlbum,"px")}},Object(n["toDisplayString"])(void 0!==this.player.musicALbum?t.name=this.player.musicALbum:""),5)],4),Object(n["createVNode"])("canvas",{ref:"info",class:"center cvs",onClick:i[1]||(i[1]=function(){return r.change_music_state.apply(r,arguments)})},null,512),Object(n["createVNode"])("audio",{ref:"myAudio",src:a("5d79"),crossorigin:"anonymous"},null,8,["src"])])})),r=(a("cb29"),a("a630"),a("d81d"),a("90d7"),a("d3b7"),a("3ca3"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("2ef0")),c=a.n(r),l=30,u=8,f=3,p=.8,d=.5,y=.012,m=.007,v=10;function x(t,i,a,n){var e=Math.round(a+i*Math.sin(t)),s=Math.round(n-i*Math.cos(t));return{x:e,y:s}}function g(){return this}function b(){return this}g.prototype.init=function(t,i,a,n){this.v={x:0,y:0},this.theta=Math.random()*Math.PI*2;var e=Math.random()*(p-d)+d;this.v.x=e*Math.sin(this.theta),this.v.y=e*-Math.cos(this.theta),this.r=Math.random()*(u-f)+f;var s=x(this.theta,a+n+v,t,i);this.cx=s.x,this.cy=s.y,this.opacity=1,this.vopa=Math.random()*(y-m)+m},g.prototype.next=function(t,i,a,n){this.cx+=this.v.x,this.cy+=this.v.y,this.opacity-=this.vopa,this.opacity<=0&&this.init(t,i,a,n)},g.prototype.draw=function(t){t.beginPath();var i=t.globalAlpha;t.arc(this.cx,this.cy,this.r,0,2*Math.PI),t.globalAlpha=this.opacity,t.fill(),t.globalAlpha=i},b.prototype.init=function(t,i,a,n){this.num=l,this.list=[];for(var e=0;e<this.num;e++){var s=new g;s.init(t,i,a,n),this.list.push(s)}},b.prototype.next=function(t,i,a,n){for(var e=0;e<this.num;e++)this.list[e].next(t,i,a,n)},b.prototype.draw=function(t){for(var i=0;i<this.num;i++)this.list[i].draw(t)};var I=30,M=8,w=3,P=.8,A=.5,S=.012,_=.007,O=10;function R(t,i,a,n){var e=Math.round(a+i*Math.sin(t)),s=Math.round(n-i*Math.cos(t));return{x:e,y:s}}function j(){return this}function k(){return this}j.prototype.init=function(t,i,a,n){this.v={x:0,y:0},this.theta=Math.random()*Math.PI*2;var e=Math.random()*(P-A)+A;this.v.x=e*Math.sin(this.theta),this.v.y=e*-Math.cos(this.theta),this.r=Math.random()*(M-w)+w;var s=R(this.theta,a+n+O,t,i);this.cx=s.x,this.cy=s.y,this.opacity=1,this.vopa=Math.random()*(S-_)+_},j.prototype.next=function(t,i,a,n){this.cx+=this.v.x,this.cy+=this.v.y,this.opacity-=this.vopa,this.opacity<=0&&this.init(t,i,a,n)},j.prototype.draw=function(t){t.beginPath();for(var i=2*Math.PI/10,a=t.globalAlpha,n=11;0!=n;n--){var e=this.r*(n%2+1)/2,s=i*n;t.lineTo(e*Math.sin(s)+this.cx,e*Math.cos(s)+this.cy)}t.globalAlpha=this.opacity,t.fill(),t.globalAlpha=a},k.prototype.init=function(t,i,a,n){this.num=I,this.list=[];for(var e=0;e<this.num;e++){var s=new j;s.init(t,i,a,n),this.list.push(s)}},k.prototype.next=function(t,i,a,n){for(var e=0;e<this.num;e++)this.list[e].next(t,i,a,n)},k.prototype.draw=function(t){for(var i=0;i<this.num;i++)this.list[i].draw(t)};var C=k,F={name:"Canvas",data:function(){return{height:650,width:650,FFTsz:2048,Smoothing:.9,powBaseRatio:.25,barNumBase:Math.log2(this.FFTsz),bars:[],info:null,ctxInfo:null,music:null,myAudioContext:null,click_count:0,ratio:null,innerR:190,avgF:0,particles:null,angle:0,step:.01*Math.PI,scaleR:2,scaleStep:.25,v:1,color_groups:[[{pos:0,code:"rgb(122,161,210)"},{pos:.4,code:"rgb(219,212,180)"},{pos:.7,code:"rgb(204,149,192)"}],[{pos:0,code:"rgb(247,121,125)"},{pos:.4,code:"rgb(251,215,134)"},{pos:.7,code:"rgb(198,255,221)"}]],player:{musicName:"手紙 ~拝啓 十五の君へ",musicAuthor:"Cover: 绯赤艾莉欧",musicALbum:"手紙~拝啓 十五の君へ~",musicState:"ready"},analyser:null,AudioContext:null,requestAnimationFrame:null,cancelAnimationFrame:null}},computed:{fontSizeName:function(){return this.player.musicName?Math.max(30-(this.player.musicName.length>6?1:0)*Math.round((this.player.musicName.length-6)/2),20):35},fontSizeAlbum:function(){return this.player.musicALbum?Math.max(12-(this.player.musicALbum.length>16?1:0)*Math.round((this.player.musicALbum.length-16)/4),8):12}},mounted:function(){var t=this;window.onload=function(){t.myAudioContext=new AudioContext,t.info=t.$refs.info,t.ctxInfo=t.info.getContext("2d"),t.music=t.$refs.myAudio,t.particles=new C,t.draw_all()}},methods:{prepare_pic:function(){var t=this.myAudioContext.createMediaElementSource(this.music);this.analyser=this.myAudioContext.createAnalyser(),this.analyser.fftSize=16384,this.analyser.smoothingTimeConstant=this.Smoothing,t.connect(this.analyser),this.analyser.connect(this.myAudioContext.destination);var i=this.myAudioContext.createScriptProcessor(1024);i.connect(this.myAudioContext.destination),this.analyser.connect(i)},thetaR2xy:function(t,i,a,n){var e=Math.round(a+i*Math.sin(t)),s=Math.round(n-i*Math.cos(t));return{x:e,y:s}},draw_smooth_curve:function(t,i,a,n,e){for(var s=a.length,o=function(t){return(t+s)%s},h=function(t,i){return{x:(t.x+i.x)/2,y:(t.y+i.y)/2}},r=0;r<s;r++)if(0===r){var c=2*Math.PI*o(r-1)/s,l=2*Math.PI*o(r)/s,u=2*Math.PI*o(r+1)/s,f=this.thetaR2xy(c,i[a[o(r-1)]],n,e),p=this.thetaR2xy(l,i[a[o(r)]],n,e),d=this.thetaR2xy(u,i[a[o(r+1)]],n,e),y=h(f,p),m=h(p,d);t.moveTo(y.x,y.y),t.quadraticCurveTo(p.x,p.y,m.x,m.y)}else{var v=2*Math.PI*o(r)/s,x=2*Math.PI*o(r+1)/s,g=this.thetaR2xy(v,i[a[o(r)]],n,e),b=this.thetaR2xy(x,i[a[o(r+1)]],n,e),I=h(g,b);t.quadraticCurveTo(g.x,g.y,I.x,I.y)}},draw_pic:function(t,i,a,n){var e=this,s={x:i/(2*this.ratio),y:a/(2*this.ratio)},o=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(o);var h=Array.from(o),r=0;if(null!==h&&void 0!==h){for(var l=0;l<h.length;l++)r+=h[l]/255;r=r/h.length*50}this.avgF=Math.min(r,50);var u=h.map((function(t){return n+e.avgF+t/3})),f=Math.pow(2,this.powBaseRatio),p=[],d=0;while(1){var y=Math.round(Math.pow(f,d)-1);if(y>=u.length)break;p.push(y),d++}var m=c.a.uniq(p);t.beginPath(),t.lineWidth=3,this.draw_smooth_curve(t,u,m,s.x,s.y),t.stroke()},draw_info:function(){this.ctxInfo.clearRect(0,0,this.info.width,this.info.height),this.ctxInfo.save();for(var t=this.info.width/(2*this.ratio),i=this.info.height/(2*this.ratio),a=this.ctxInfo.createRadialGradient(t,i,this.innerR+this.avgF,t,i,275),n=1,e=0;e<this.color_groups[n].length;e++)a.addColorStop(this.color_groups[n][e].pos,this.color_groups[n][e].code);this.ctxInfo.beginPath(),this.ctxInfo.strokeStyle=a,this.ctxInfo.fillStyle=a,this.ctxInfo.lineWidth=3;var s=this.music.currentTime/this.music.duration*2*Math.PI;this.ctxInfo.arc(t,i,this.innerR+this.avgF,-Math.PI/2,-Math.PI/2+s);var o=this.ctxInfo.globalAlpha;this.ctxInfo.globalAlpha=.3,this.ctxInfo.stroke(),this.ctxInfo.beginPath(),this.ctxInfo.lineWidth=2,this.ctxInfo.arc(t,i,this.innerR+this.avgF,-Math.PI/2+s,3*Math.PI/2),this.ctxInfo.globalAlpha=.7,this.ctxInfo.stroke(),this.ctxInfo.globalAlpha=o,this.draw_pic(this.ctxInfo,this.info.width,this.info.height,200),this.particles.draw(this.ctxInfo),this.particles.next(this.info.width/(2*this.ratio),this.info.height/(2*this.ratio),this.innerR,this.avgF);var h=this.info.width/(2*this.ratio)+Math.sin(s)*(this.innerR+this.avgF),r=this.info.height/(2*this.ratio)-Math.cos(s)*(this.innerR+this.avgF);this.ctxInfo.beginPath(),this.ctxInfo.arc(h,r,this.scaleR,0,2*Math.PI),this.ctxInfo.fillStyle="rgba(255,255,255,0.3)",this.ctxInfo.fill();var c=new Path2D;c.arc(h,r,8,0,2*Math.PI),this.ctxInfo.fillStyle="rgba(255,255,255,0.9)",this.ctxInfo.fill(c),this.ctxInfo.beginPath(),this.ctxInfo.lineWidth=6,this.ctxInfo.arc(h,r,15,this.angle,this.angle+Math.PI/3),this.ctxInfo.strokeStyle="rgba(255,255,255,0.7)",this.ctxInfo.stroke(),this.ctxInfo.beginPath(),this.ctxInfo.lineWidth=6,this.ctxInfo.arc(h,r,15,this.angle+Math.PI,this.angle+4*Math.PI/3),this.ctxInfo.strokeStyle="rgba(255,255,255,0.7)",this.ctxInfo.stroke(),this.ctxInfo.restore(),this.angle=this.angle+this.step,this.angle>=2*Math.PI&&(this.angle=this.angle-2*Math.PI),this.scaleR+=this.scaleStep*this.v,this.scaleR>=32&&(this.v=-1),this.scaleR<=2&&(this.v=1)},init_music:function(){var t=this;this.music.load();var i=this.music.play();void 0!==i&&i.then((function(i){console.log("music play successfully."),t.player.musicState="playing"})).catch((function(t){console.log(t)}))},change_music_state:function(){var t=this;if(this.click_count+=1,1==this.click_count)this.myAudioContext.resume().then((function(){console.log("AudioContext resume successfully."),t.init_music()}));else{if(""===this.player.musicPath)return;"ready"===this.player.musicState?this.init_music():"paused"===this.player.musicState?(this.music.play(),this.player.musicState="playing"):"playing"===this.player.musicState&&(this.music.pause(),this.player.musicState="paused")}},init_canvas:function(t,i){t.width=this.width,t.height=this.height;var a=window.devicePixelRatio||1,n=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1;if(this.ratio=a/n,a!==n){var e=t.width,s=t.height;t.width=e*this.ratio,t.height=s*this.ratio,t.style.width=e+"px",t.style.height=s+"px",i.scale(this.ratio,this.ratio)}},initCanvases:function(){this.init_canvas(this.info,this.ctxInfo)},draw_all:function(){var t=this,i=function i(){t.draw_info(),requestAnimationFrame(i)};this.prepare_pic(),this.initCanvases(),this.particles.init(this.info.width/(2*this.ratio),this.info.height/(2*this.ratio),this.innerR,this.avgF),requestAnimationFrame(i)}}};a("9ac2");F.render=h,F.__scopeId="data-v-0aa86c20";var N=F,B={name:"App",components:{Canvas:N}};a("9757");B.render=e;var z=B,T=a("46bd"),q=a.n(T),L=(a("7dd6"),Object(n["createApp"])(z));L.use(q.a),L.mount("#app")},"5d79":function(t,i,a){t.exports=a.p+"media/song.fb887f67.mp3"},"6c30":function(t,i,a){},9757:function(t,i,a){"use strict";a("aa36")},"9ac2":function(t,i,a){"use strict";a("6c30")},aa36:function(t,i,a){}});
//# sourceMappingURL=app.cb748d1c.js.map