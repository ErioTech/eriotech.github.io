(function(t){function i(i){for(var e,o,h=i[0],r=i[1],c=i[2],u=0,f=[];u<h.length;u++)o=h[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);l&&l(i);while(f.length)f.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,i=0;i<s.length;i++){for(var n=s[i],e=!0,h=1;h<n.length;h++){var r=n[h];0!==a[r]&&(e=!1)}e&&(s.splice(i--,1),t=o(o.s=n[0]))}return t}var e={},a={app:0},s=[];function o(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,i,n){o.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,i){if(1&i&&(t=o(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var e in t)o.d(n,e,function(i){return t[i]}.bind(null,e));return n},o.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(i,"a",i),i},o.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},o.p="";var h=window["webpackJsonp"]=window["webpackJsonp"]||[],r=h.push.bind(h);h.push=i,h=h.slice();for(var c=0;c<h.length;c++)i(h[c]);var l=r;s.push([0,"chunk-vendors"]),n()})({0:function(t,i,n){t.exports=n("56d7")},"0976":function(t,i,n){"use strict";n("0c63")},"0c63":function(t,i,n){},4572:function(t,i,n){"use strict";n("65d9")},"56d7":function(t,i,n){"use strict";n.r(i);n("e260"),n("e6cf"),n("cca6"),n("a79d");var e=n("7a23");function a(t,i,n,a,s,o){var h=Object(e["resolveComponent"])("Canvas");return Object(e["openBlock"])(),Object(e["createBlock"])(h,{width:650,height:650})}n("b0c0");var s=Object(e["withScopeId"])("data-v-7b89f0b6");Object(e["pushScopeId"])("data-v-7b89f0b6");var o={class:"author-div"};Object(e["popScopeId"])();var h=s((function(t,i,a,s,h,r){return Object(e["openBlock"])(),Object(e["createBlock"])("div",null,[Object(e["createVNode"])("div",{style:{width:"".concat(h.width,"px"),height:"".concat(h.height,"px")},class:"outer-div"},[Object(e["createVNode"])("div",{class:"name-div",style:{"font-size":"".concat(r.fontSizeName,"px")}},Object(e["toDisplayString"])(void 0!==this.player.musicName?t.name=this.player.musicName:""),5),Object(e["createVNode"])("div",o,Object(e["toDisplayString"])(void 0!==this.player.musicAuthor?t.name=this.player.musicAuthor:""),1),Object(e["createVNode"])("div",{class:"album-div",style:{"font-size":"".concat(r.fontSizeAlbum,"px")}},Object(e["toDisplayString"])(void 0!==this.player.musicALbum?t.name=this.player.musicALbum:""),5)],4),Object(e["createVNode"])("canvas",{ref:"info",class:"center cvs",onClick:i[1]||(i[1]=function(){return r.change_music_state.apply(r,arguments)})},null,512),Object(e["createVNode"])("audio",{ref:"myAudio",src:n("5d79"),crossorigin:"anonymous"},null,8,["src"])])})),r=(n("cb29"),n("a630"),n("d81d"),n("90d7"),n("d3b7"),n("3ca3"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("2ef0")),c=n.n(r),l=30,u=8,f=3,p=.8,d=.5,y=.012,m=.007,v=10;function x(t,i,n,e){var a=Math.round(n+i*Math.sin(t)),s=Math.round(e-i*Math.cos(t));return{x:a,y:s}}function g(){return this}function b(){return this}g.prototype.init=function(t,i,n,e){this.v={x:0,y:0},this.theta=Math.random()*Math.PI*2;var a=Math.random()*(p-d)+d;this.v.x=a*Math.sin(this.theta),this.v.y=a*-Math.cos(this.theta),this.r=Math.random()*(u-f)+f;var s=x(this.theta,n+e+v,t,i);this.cx=s.x,this.cy=s.y,this.opacity=1,this.vopa=Math.random()*(y-m)+m},g.prototype.next=function(t,i,n,e){this.cx+=this.v.x,this.cy+=this.v.y,this.opacity-=this.vopa,this.opacity<=0&&this.init(t,i,n,e)},g.prototype.draw=function(t){t.beginPath();var i=t.globalAlpha;t.arc(this.cx,this.cy,this.r,0,2*Math.PI),t.globalAlpha=this.opacity,t.fill(),t.globalAlpha=i},b.prototype.init=function(t,i,n,e){this.num=l,this.list=[];for(var a=0;a<this.num;a++){var s=new g;s.init(t,i,n,e),this.list.push(s)}},b.prototype.next=function(t,i,n,e){for(var a=0;a<this.num;a++)this.list[a].next(t,i,n,e)},b.prototype.draw=function(t){for(var i=0;i<this.num;i++)this.list[i].draw(t)};var I=30,M=8,w=3,P=.8,A=.5,S=.012,_=.007,O=10;function R(t,i,n,e){var a=Math.round(n+i*Math.sin(t)),s=Math.round(e-i*Math.cos(t));return{x:a,y:s}}function j(){return this}function k(){return this}j.prototype.init=function(t,i,n,e){this.v={x:0,y:0},this.theta=Math.random()*Math.PI*2;var a=Math.random()*(P-A)+A;this.v.x=a*Math.sin(this.theta),this.v.y=a*-Math.cos(this.theta),this.r=Math.random()*(M-w)+w;var s=R(this.theta,n+e+O,t,i);this.cx=s.x,this.cy=s.y,this.opacity=1,this.vopa=Math.random()*(S-_)+_},j.prototype.next=function(t,i,n,e){this.cx+=this.v.x,this.cy+=this.v.y,this.opacity-=this.vopa,this.opacity<=0&&this.init(t,i,n,e)},j.prototype.draw=function(t){t.beginPath();for(var i=2*Math.PI/10,n=t.globalAlpha,e=11;0!=e;e--){var a=this.r*(e%2+1)/2,s=i*e;t.lineTo(a*Math.sin(s)+this.cx,a*Math.cos(s)+this.cy)}t.globalAlpha=this.opacity,t.fill(),t.globalAlpha=n},k.prototype.init=function(t,i,n,e){this.num=I,this.list=[];for(var a=0;a<this.num;a++){var s=new j;s.init(t,i,n,e),this.list.push(s)}},k.prototype.next=function(t,i,n,e){for(var a=0;a<this.num;a++)this.list[a].next(t,i,n,e)},k.prototype.draw=function(t){for(var i=0;i<this.num;i++)this.list[i].draw(t)};var C=k,F={name:"Canvas",data:function(){return{height:650,width:650,FFTsz:2048,Smoothing:.9,powBaseRatio:.25,barNumBase:Math.log2(this.FFTsz),bars:[],info:null,ctxInfo:null,music:null,myAudioContext:null,click_count:0,ratio:null,innerR:190,avgF:0,particles:null,angle:0,step:.01*Math.PI,scaleR:2,scaleStep:.25,v:1,color_groups:[[{pos:0,code:"rgb(122,161,210)"},{pos:.4,code:"rgb(219,212,180)"},{pos:.7,code:"rgb(204,149,192)"}],[{pos:0,code:"rgb(247,121,125)"},{pos:.4,code:"rgb(251,215,134)"},{pos:.7,code:"rgb(198,255,221)"}]],player:{musicName:"僕が死のうと思ったのは",musicAuthor:"Cover: 绯赤艾莉欧",musicALbum:"僕が死のうと思ったのは",musicState:"ready"},analyser:null,AudioContext:null,requestAnimationFrame:null,cancelAnimationFrame:null}},computed:{fontSizeName:function(){return this.player.musicName?Math.max(30-(this.player.musicName.length>6?1:0)*Math.round((this.player.musicName.length-6)/2),20):35},fontSizeAlbum:function(){return this.player.musicALbum?Math.max(12-(this.player.musicALbum.length>16?1:0)*Math.round((this.player.musicALbum.length-16)/4),8):12}},mounted:function(){var t=this;window.onload=function(){t.myAudioContext=new AudioContext,t.info=t.$refs.info,t.ctxInfo=t.info.getContext("2d"),t.music=t.$refs.myAudio,t.particles=new C,t.draw_all()}},methods:{prepare_pic:function(){var t=this.myAudioContext.createMediaElementSource(this.music);this.analyser=this.myAudioContext.createAnalyser(),this.analyser.fftSize=16384,this.analyser.smoothingTimeConstant=this.Smoothing,t.connect(this.analyser),this.analyser.connect(this.myAudioContext.destination);var i=this.myAudioContext.createScriptProcessor(1024);i.connect(this.myAudioContext.destination),this.analyser.connect(i)},thetaR2xy:function(t,i,n,e){var a=Math.round(n+i*Math.sin(t)),s=Math.round(e-i*Math.cos(t));return{x:a,y:s}},draw_smooth_curve:function(t,i,n,e,a){for(var s=n.length,o=function(t){return(t+s)%s},h=function(t,i){return{x:(t.x+i.x)/2,y:(t.y+i.y)/2}},r=0;r<s;r++)if(0===r){var c=2*Math.PI*o(r-1)/s,l=2*Math.PI*o(r)/s,u=2*Math.PI*o(r+1)/s,f=this.thetaR2xy(c,i[n[o(r-1)]],e,a),p=this.thetaR2xy(l,i[n[o(r)]],e,a),d=this.thetaR2xy(u,i[n[o(r+1)]],e,a),y=h(f,p),m=h(p,d);t.moveTo(y.x,y.y),t.quadraticCurveTo(p.x,p.y,m.x,m.y)}else{var v=2*Math.PI*o(r)/s,x=2*Math.PI*o(r+1)/s,g=this.thetaR2xy(v,i[n[o(r)]],e,a),b=this.thetaR2xy(x,i[n[o(r+1)]],e,a),I=h(g,b);t.quadraticCurveTo(g.x,g.y,I.x,I.y)}},draw_pic:function(t,i,n,e){var a=this,s={x:i/(2*this.ratio),y:n/(2*this.ratio)},o=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(o);var h=Array.from(o),r=0;if(null!==h&&void 0!==h){for(var l=0;l<h.length;l++)r+=h[l]/255;r=r/h.length*50}this.avgF=Math.min(r,50);var u=h.map((function(t){return e+a.avgF+t/3})),f=Math.pow(2,this.powBaseRatio),p=[],d=0;while(1){var y=Math.round(Math.pow(f,d)-1);if(y>=u.length)break;p.push(y),d++}var m=c.a.uniq(p);t.beginPath(),t.lineWidth=3,this.draw_smooth_curve(t,u,m,s.x,s.y),t.stroke()},draw_info:function(){this.ctxInfo.clearRect(0,0,this.info.width,this.info.height),this.ctxInfo.save();for(var t=this.info.width/(2*this.ratio),i=this.info.height/(2*this.ratio),n=this.ctxInfo.createRadialGradient(t,i,this.innerR+this.avgF,t,i,275),e=1,a=0;a<this.color_groups[e].length;a++)n.addColorStop(this.color_groups[e][a].pos,this.color_groups[e][a].code);this.ctxInfo.beginPath(),this.ctxInfo.strokeStyle=n,this.ctxInfo.fillStyle=n,this.ctxInfo.lineWidth=3;var s=this.music.currentTime/this.music.duration*2*Math.PI;this.ctxInfo.arc(t,i,this.innerR+this.avgF,-Math.PI/2,-Math.PI/2+s);var o=this.ctxInfo.globalAlpha;this.ctxInfo.globalAlpha=.3,this.ctxInfo.stroke(),this.ctxInfo.beginPath(),this.ctxInfo.lineWidth=2,this.ctxInfo.arc(t,i,this.innerR+this.avgF,-Math.PI/2+s,3*Math.PI/2),this.ctxInfo.globalAlpha=.7,this.ctxInfo.stroke(),this.ctxInfo.globalAlpha=o,this.draw_pic(this.ctxInfo,this.info.width,this.info.height,200),this.particles.draw(this.ctxInfo),this.particles.next(this.info.width/(2*this.ratio),this.info.height/(2*this.ratio),this.innerR,this.avgF);var h=this.info.width/(2*this.ratio)+Math.sin(s)*(this.innerR+this.avgF),r=this.info.height/(2*this.ratio)-Math.cos(s)*(this.innerR+this.avgF);this.ctxInfo.beginPath(),this.ctxInfo.arc(h,r,this.scaleR,0,2*Math.PI),this.ctxInfo.fillStyle="rgba(255,255,255,0.3)",this.ctxInfo.fill();var c=new Path2D;c.arc(h,r,8,0,2*Math.PI),this.ctxInfo.fillStyle="rgba(255,255,255,0.9)",this.ctxInfo.fill(c),this.ctxInfo.beginPath(),this.ctxInfo.lineWidth=6,this.ctxInfo.arc(h,r,15,this.angle,this.angle+Math.PI/3),this.ctxInfo.strokeStyle="rgba(255,255,255,0.7)",this.ctxInfo.stroke(),this.ctxInfo.beginPath(),this.ctxInfo.lineWidth=6,this.ctxInfo.arc(h,r,15,this.angle+Math.PI,this.angle+4*Math.PI/3),this.ctxInfo.strokeStyle="rgba(255,255,255,0.7)",this.ctxInfo.stroke(),this.ctxInfo.restore(),this.angle=this.angle+this.step,this.angle>=2*Math.PI&&(this.angle=this.angle-2*Math.PI),this.scaleR+=this.scaleStep*this.v,this.scaleR>=32&&(this.v=-1),this.scaleR<=2&&(this.v=1)},init_music:function(){var t=this;this.music.load();var i=this.music.play();void 0!==i&&i.then((function(i){console.log("music play successfully."),t.player.musicState="playing"})).catch((function(t){console.log(t)}))},change_music_state:function(){var t=this;if(this.click_count+=1,1==this.click_count)this.myAudioContext.resume().then((function(){console.log("AudioContext resume successfully."),t.init_music()}));else{if(""===this.player.musicPath)return;"ready"===this.player.musicState?this.init_music():"paused"===this.player.musicState?(this.music.play(),this.player.musicState="playing"):"playing"===this.player.musicState&&(this.music.pause(),this.player.musicState="paused")}},init_canvas:function(t,i){t.width=this.width,t.height=this.height;var n=window.devicePixelRatio||1,e=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1;if(this.ratio=n/e,n!==e){var a=t.width,s=t.height;t.width=a*this.ratio,t.height=s*this.ratio,t.style.width=a+"px",t.style.height=s+"px",i.scale(this.ratio,this.ratio)}},initCanvases:function(){this.init_canvas(this.info,this.ctxInfo)},draw_all:function(){var t=this,i=function i(){t.draw_info(),requestAnimationFrame(i)};this.prepare_pic(),this.initCanvases(),this.particles.init(this.info.width/(2*this.ratio),this.info.height/(2*this.ratio),this.innerR,this.avgF),requestAnimationFrame(i)}}};n("4572");F.render=h,F.__scopeId="data-v-7b89f0b6";var N=F,B={name:"App",components:{Canvas:N}};n("0976");B.render=a;var z=B,T=n("46bd"),q=n.n(T),L=(n("7dd6"),Object(e["createApp"])(z));L.use(q.a),L.mount("#app")},"5d79":function(t,i,n){t.exports=n.p+"media/song.ed9bcc64.mp3"},"65d9":function(t,i,n){}});
//# sourceMappingURL=app.d999d06a.js.map